<%
  post_excerpt = @post.respond_to?(:excerpt) && @post.excerpt.present? ?
                 @post.excerpt :
                 truncate(strip_tags(@post.content.to_s), length: 160)

  created_time = @post.respond_to?(:created_at) ? @post.created_at : nil
  published_time = @post.respond_to?(:published_at) ? @post.published_at : created_time
  updated_time = @post.respond_to?(:updated_at) ? @post.updated_at : created_time

  set_article_meta(
    title: @post.title,
    description: post_excerpt,
    author: @post.respond_to?(:author) ? @post.author : nil,
    published_at: published_time,
    updated_at: updated_time,
    image: @post.respond_to?(:image_url) ? @post.image_url : nil,
    category: @post.respond_to?(:category) ? @post.category : nil
  )
%>

<% content_for :json_ld do %>
  <%= json_ld_tag(breadcrumb_json_ld([
    { name: "홈", url: root_path },
    { name: "블로그", url: blog_index_path },
    { name: @post.title, url: nil }
  ])) %>
  <%= json_ld_tag(article_json_ld(@post)) %>
<% end %>

<!-- Breadcrumb -->
<section class="bg-gray-100 py-4">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <nav class="flex items-center text-sm text-gray-600">
      <%= link_to "홈", root_path, class: "hover:text-indigo-600" %>
      <span class="mx-2">/</span>
      <%= link_to "블로그", blog_index_path, class: "hover:text-indigo-600" %>
      <span class="mx-2">/</span>
      <span class="text-gray-900 truncate"><%= @post.title %></span>
    </nav>
  </div>
</section>

<!-- Article -->
<article class="py-12">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Header -->
    <header class="mb-8 text-center">
      <% if @post.category.present? %>
        <span class="inline-block px-3 py-1 bg-indigo-100 text-indigo-700 rounded-full text-sm font-medium mb-4">
          <%= @post.category %>
        </span>
      <% end %>
      <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-6">
        <%= @post.title %>
      </h1>
      <% if @post.author.present? %>
        <div class="flex items-center justify-center gap-4 text-gray-600">
          <div class="flex items-center">
            <div class="w-10 h-10 bg-indigo-600 rounded-full flex items-center justify-center text-white font-bold mr-3">
              <%= @post.author[0] %>
            </div>
            <div class="text-left">
              <p class="font-medium text-gray-900"><%= @post.author %></p>
              <p class="text-sm text-gray-500"><%= @post.published_at&.strftime("%Y-%m-%d") %></p>
            </div>
          </div>
        </div>
      <% end %>
    </header>

    <!-- Featured Image -->
    <% if @post.large_url.present? || @post.image_url.present? %>
      <div class="aspect-video rounded-xl overflow-hidden mb-8">
        <img src="<%= @post.large_url || @post.image_url %>" alt="<%= @post.title %>"
             class="w-full h-full object-cover">
      </div>
    <% end %>

    <!-- Content Body -->
    <div class="prose prose-lg max-w-none">
      <% if @post.excerpt.present? %>
        <p class="text-xl text-gray-600 mb-8">
          <%= @post.excerpt %>
        </p>
      <% end %>

      <% if @post.content.present? %>
        <%= simple_format(@post.content) %>
      <% else %>
        <p>
          L-BIZ Partners는 항상 클라이언트의 성공을 최우선으로 생각합니다.
          우리의 모든 프로젝트는 철저한 분석과 전략적 접근을 통해 진행되며,
          각 기업의 고유한 상황과 목표에 맞춘 맞춤형 솔루션을 제공합니다.
        </p>

        <h2 class="text-2xl font-bold mt-8 mb-4">프로젝트 접근 방식</h2>

        <p>
          성공적인 프로젝트를 위해서는 명확한 목표 설정, 체계적인 계획 수립,
          그리고 지속적인 모니터링과 피드백이 필수적입니다.
          L-BIZ Partners는 이러한 과정을 통해 클라이언트와 함께 성장합니다.
        </p>

        <ol class="list-decimal pl-6 space-y-2">
          <li>현황 분석 및 목표 설정</li>
          <li>전략 수립 및 로드맵 작성</li>
          <li>실행 계획 구체화</li>
          <li>지속적인 모니터링 및 개선</li>
          <li>성과 측정 및 피드백</li>
        </ol>

        <h2 class="text-2xl font-bold mt-8 mb-4">함께 성장하는 파트너십</h2>

        <p>
          단순한 용역 관계가 아닌, 진정한 파트너십을 통해 클라이언트의 장기적인 성공을 돕습니다.
          우리는 각 프로젝트에서 얻은 경험과 인사이트를 바탕으로 더 나은 서비스를 제공하기 위해
          끊임없이 노력하고 있습니다.
        </p>

        <blockquote class="border-l-4 border-indigo-600 pl-4 my-6 italic text-gray-700">
          "파트너의 성공이 곧 우리의 성공입니다. L-BIZ Partners는 항상 함께 성장합니다."
        </blockquote>

        <p>
          더 자세한 내용이 궁금하시거나 협업을 원하시면 언제든지 연락주세요.
          L-BIZ Partners가 귀사의 성공적인 비즈니스를 위해 함께하겠습니다.
        </p>
      <% end %>
    </div>

    <!-- Share & Tags -->
    <div class="mt-8 pt-8 border-t">
      <div class="flex flex-wrap justify-between items-center gap-4">
        <!-- Tags -->
        <div class="flex flex-wrap gap-2">
          <% if @post.category.present? %>
            <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm">#<%= @post.category %></span>
          <% end %>
          <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm">#비즈니스</span>
          <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm">#LBIZ</span>
        </div>
        <!-- Share -->
        <div class="flex items-center gap-2">
          <span class="text-sm text-gray-500">공유하기:</span>
          <button class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center hover:bg-gray-200 transition-colors">
            <svg class="w-4 h-4 text-gray-600" fill="currentColor" viewBox="0 0 24 24">
              <path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"/>
            </svg>
          </button>
          <button class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center hover:bg-gray-200 transition-colors">
            <svg class="w-4 h-4 text-gray-600" fill="currentColor" viewBox="0 0 24 24">
              <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Author Box -->
    <% if @post.author.present? %>
      <div class="mt-8 p-6 bg-gray-50 rounded-xl">
        <div class="flex items-start gap-4">
          <div class="w-16 h-16 bg-indigo-600 rounded-full flex items-center justify-center text-white text-2xl font-bold flex-shrink-0">
            <%= @post.author[0] %>
          </div>
          <div>
            <h3 class="font-bold text-gray-900 mb-1"><%= @post.author %></h3>
            <p class="text-gray-600 text-sm">
              L-BIZ Partners의 전문 컨설턴트로 다양한 비즈니스 프로젝트를 성공적으로 이끌고 있습니다.
              기업 전략 수립과 디지털 혁신 분야에서 풍부한 경험을 보유하고 있습니다.
            </p>
          </div>
        </div>
      </div>
    <% end %>

    <!-- Navigation -->
    <div class="mt-8 pt-8 border-t flex justify-between items-center">
      <%= link_to blog_index_path, class: "inline-flex items-center text-indigo-600 hover:text-indigo-700 font-medium" do %>
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
        </svg>
        블로그 목록
      <% end %>
      <%= link_to "문의하기", new_contact_path, class: "inline-block bg-indigo-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-indigo-700 transition-colors" %>
    </div>
  </div>
</article>

<!-- Related Posts -->
<section class="bg-gray-50 py-16">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <h2 class="text-2xl font-bold text-gray-900 mb-8 text-center">관련 포스트</h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
      <% 3.times do |i| %>
        <div class="bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-lg transition-shadow duration-300">
          <div class="aspect-video bg-gradient-to-br from-indigo-400 to-purple-600"></div>
          <div class="p-6">
            <span class="text-sm text-gray-500">관련 포스트 <%= i + 1 %></span>
            <h3 class="text-lg font-bold text-gray-900 mt-2">더 많은 이야기를 확인하세요</h3>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</section>
